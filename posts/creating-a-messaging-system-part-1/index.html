<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <title>Creating a Messaging System From Scratch Part 1</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="First-name Last-name">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
<link href='/assets/stylesheets/bootstrap.min-44b0e86075f7695d94fa4ccff20f154f.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/style-c3fb81717ea351ecd7881fb4397918ca.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/google_prettify/sons-of-obsidian-f9af5ce9981ba9862d865de32f2390b0.css' type='text/css' rel='stylesheet' media='all'>
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>
  
<nav class="main-nav">
    <div class="navigation text-center">
          <a class="lead" href="/../">Home</a>

          <a class="lead" href="/../about">About</a>

          <a class="lead" href="/../archive">Archives</a>
          <a class="lead" href="/../tags">Tags</a>
    </div>
  </nav>

    <div class="root-content">
        <div class="container-narrow">
            <div class="none">
                
<div class="text-center posts-title">
  <div class="page-header">
    <h1>Creating a Messaging System From Scratch Part 1 </h1>
  </div>

  <div class="posts-date">
      <span>March 25, 2014</strong>
  </div>

</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>&nbsp; &nbsp; &nbsp;&nbsp;In this series of posts, I&#39;m going to share my experience of how I created a private messaging system between two users. The reason I picked this topic is because I noticed that many other developers had
<a href="http://stackoverflow.com/questions/5102832/rails-private-message-system">faced similar questions</a> and
<a href="http://stackoverflow.com/questions/18952216/rails-3-set-a-conversation-id-for-private-messaging">problems</a>
while I was browsing the StackOverFlow threads on the same topic. There was not a consensus among the community on how to develop a private messaging system, only that doing it from scratch would be most convenient for (we) the developers without having to implement an entire gem (i.e. mailboxer) for overkill. </p>

<p>I first started with the logic:<br>
&nbsp; &nbsp; 1.  A user can send many messages and therefore has many messages.<br>
&nbsp; &nbsp; 2.  A message can have a sender and a recipient and therefore belongs to a sender and a recipient.<br>
So the two models I start out with are these:</p>

<pre><code>class User &lt; ActiveRecord::Base
    has_many :messages, 
       foreign_key: &quot;messenger_id&quot;
    has_many :received_messages, 
       class_name: &quot;Message&quot;,
       foreign_key: &quot;recipient_id&quot;
end    
</code></pre>

<p>And this:</p>

<pre><code>class Message &lt; ActiveRecord::Base
    attr_accessible :content, :messenger_id, :recipient_id

    belongs_to :messenger, 
               class_name: &quot;User&quot;,
               foreign_key: &quot;messenger_id&quot;


    belongs_to :recipient, 
                class_name: &quot;User&quot;, 
                foreign_key: &quot;recipient_id&quot;
end
</code></pre>

    </div>
    <div class="text-center">
      <ul class="tag_box inline">
          <li><i class="icon-folder-open"></i></li>
        </ul>
        <ul class="tag_box inline">
          <li><i class="icon-tags"></i></li>
        </ul>
        <hr>
        <div class="pagination">
          <ul>
              <li class="prev"><a href="/posts/hello-moto" title="How Relations Work In Rails">&larr; Previous</a></li>
    
              <li><a href="/archive">Archive</a></li>
    
              <li class="next disabled"><a>Next &rarr;</a>
          </ul>
        </div>
        <hr>
        
      </div>
    </div>
</div> 


            </div>
              <div class="footer">
                <p>&copy; First-name Last-name 2013
                  with help from <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a>
                  and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
              </div>
        </div> <!-- /container -->

            <!-- Google Prettify -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i=0; i < pres.length; ++i) {
    pres[i].className = "prettyprint linenums";
  }
  prettyPrint();
</script>
<!-- end Google Prettify -->
            
    </div>

  </body>
  <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
 
</html>
